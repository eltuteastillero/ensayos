<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Prueba Supabase</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
</head>
<body>
  <h1>Prueba de concepto Supabase</h1>

  <input id="mensaje" type="text" placeholder="Escribe un mensaje">
  <button onclick="insertar()">Insertar</button>
  <button onclick="leer()">Leer</button>

  <ul id="lista"></ul>

  <script>
    // Configura tu Supabase
    const supabaseUrl = "https://kbtdpnfrusbsxmedrbbn.supabase.co";
    const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtidGRwbmZydXNic3htZWRyYmJuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc3OTQ4MjksImV4cCI6MjA3MzM3MDgyOX0.iQLKWXCBLzmxVd2pfjoO_9gfAsmyLlPcsDkveNMbwpg";
    const supabase = supabase.createClient(supabaseUrl, supabaseKey);

    async function insertar() {
      const valor = document.getElementById("mensaje").value;
      const { data, error } = await supabase
        .from("mensajes")
        .insert([{ contenido: valor }]);
      if (error) {
        console.error(error);
        alert("Error insertando");
      } else {
        alert("Insertado!");
      }
    }

    async function leer() {
      const { data, error } = await supabase
        .from("mensajes")
        .select("*")
        .order("created_at", { ascending: false });

      if (error) {
        console.error(error);
        alert("Error leyendo");
      } else {
        const lista = document.getElementById("lista");
        lista.innerHTML = "";
        data.forEach(item => {
          const li = document.createElement("li");
          li.textContent = item.contenido + " (" + item.created_at + ")";
          lista.appendChild(li);
        });
      }
    }
  </script>
</body>
</html>
